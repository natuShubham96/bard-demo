"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.toWatchable = void 0;
const IS_PROXY = Symbol("IS_PROXY");
const toWatchable = (target, events) => {
    const handler = {
        get(target, key) {
            if (key === IS_PROXY)
                return true;
            const prop = target[key];
            if (prop == null)
                return;
            if (!prop[IS_PROXY] && typeof prop === "object") {
                target[key] = new Proxy(prop, handler);
            }
            if (events === null || events === void 0 ? void 0 : events.onRequest)
                events.onRequest();
            return target[key];
        },
        set(target, key, value) {
            target[key] = value;
            if (events === null || events === void 0 ? void 0 : events.onUpdate)
                events.onUpdate();
            return true;
        }
    };
    return new Proxy(target, handler);
};
exports.toWatchable = toWatchable;
//# sourceMappingURL=proxy.js.map